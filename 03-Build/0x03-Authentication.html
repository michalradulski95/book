
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Authentication Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="0x04-SessionManagement.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    README
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../00-Introduction/Introduction.html">
            
                <a href="../00-Introduction/Introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../00-Introduction/Authors.html">
            
                <a href="../00-Introduction/Authors.html">
            
                    
                    Authors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../00-Introduction/00-Foreword.html">
            
                <a href="../00-Introduction/00-Foreword.html">
            
                    
                    Foreword
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../00-Introduction/01-About the Development Guide.html">
            
                <a href="../00-Introduction/01-About the Development Guide.html">
            
                    
                    About the Development Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../00-Introduction/02-About the Open Web Application Security Project.html">
            
                <a href="../00-Introduction/02-About the Open Web Application Security Project.html">
            
                    
                    About the Open Web Application Security Project
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Foundations
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../01-Foundations/01-Security Fundamentals.html">
            
                <a href="../01-Foundations/01-Security Fundamentals.html">
            
                    
                    Security Fundamentals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../01-Foundations/02-Policies, Standards and Guidelines.html">
            
                <a href="../01-Foundations/02-Policies, Standards and Guidelines.html">
            
                    
                    Policies, Standards, and Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../01-Foundations/03-Risk management.html">
            
                <a href="../01-Foundations/03-Risk management.html">
            
                    
                    Risk management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../01-Foundations/04-Secure Development Lifecycle.html">
            
                <a href="../01-Foundations/04-Secure Development Lifecycle.html">
            
                    
                    Secure Development Lifecycle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../01-Foundations/05-Training.html">
            
                <a href="../01-Foundations/05-Training.html">
            
                    
                    Training
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../01-Foundations/06-Aquiring secure software.html">
            
                <a href="../01-Foundations/06-Aquiring secure software.html">
            
                    
                    Acquiring secure software
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Design
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../02-Design/01-Principles of Security Engineering.html">
            
                <a href="../02-Design/01-Principles of Security Engineering.html">
            
                    
                    Principles of Security Engineering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../02-Design/02-Security Architecture.html">
            
                <a href="../02-Design/02-Security Architecture.html">
            
                    
                    Security Architecture
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Build
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.1" data-path="0x03-Authentication.html">
            
                <a href="0x03-Authentication.html">
            
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="0x04-SessionManagement.html">
            
                <a href="0x04-SessionManagement.html">
            
                    
                    Session management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="0x05-AccessControl.html">
            
                <a href="0x05-AccessControl.html">
            
                    
                    Access control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="0x06-InputValidation.html">
            
                <a href="0x06-InputValidation.html">
            
                    
                    Input validation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="0x06-OutputEncoding.html">
            
                <a href="0x06-OutputEncoding.html">
            
                    
                    Output encoding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="0x07-BusinessLogic.html">
            
                <a href="0x07-BusinessLogic.html">
            
                    
                    Business logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="0x08-Accountability.html">
            
                <a href="0x08-Accountability.html">
            
                    
                    Accountability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="0x09-DataProtection.html">
            
                <a href="0x09-DataProtection.html">
            
                    
                    Data protection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="0x10-FilesAndResources.html">
            
                <a href="0x10-FilesAndResources.html">
            
                    
                    Files and resources
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="0x11-Cryptography.html">
            
                <a href="0x11-Cryptography.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="0x14-Memory.html">
            
                <a href="0x14-Memory.html">
            
                    
                    Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="0x15-Concurrency.html">
            
                <a href="0x15-Concurrency.html">
            
                    
                    Concurrency
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Operational security
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../04-OperationalSecurity/Administrative-Interfaces.html">
            
                <a href="../04-OperationalSecurity/Administrative-Interfaces.html">
            
                    
                    Administrative interfaces
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Authentication</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="overview">Overview</h3>
<p>Overview</p>
<p>Authentication is TBA.</p>
<h3 id="principles">Principles</h3>
<h4 id="evidence-of-identity">Evidence of Identity</h4>
<p>Authentication is the process of establishing a strong link between a person and an electronic identity principal, which is generally stored in a user object store, like an LDAP server, database, or Active Directory. 
The evidence of identity in the registration process should be in line with the business risk of the application. For example, the evidence of identity for a tax return application or banking application should be quite rigorous, as anti-money laundering laws and other local laws and regulations apply, whereas the evidence of identity for social networks can be very relaxed unless there are local laws requiring real names to be used. 
Evidence of identity post registration applies even if anonymous usage is encouraged or mandated. For example, under many Privacy regimes, there is a requirement that users must be given an opportunity to deal with an organization anonymously, and all business processes and storage preserves that anonymity. For example, if a user wishes to register for a competition, their name should not appear as a winner unless the user has consented to that usage. 
Another misconception about evidence of identity is that it only applies during registration, but it also applies for all authentication attempts. For example, user X of a whistle blowing application expects that no one else can impersonate user X. This means adequate proof of identity is provided when logging in, such as the use of multi-factor authentication. The use of passwords alone is no longer considered safe, and so authentication should be multi-factor or risk based to prevent attackers obtaining an account improperly. </p>
<h4 id="complete-mediation">Complete mediation</h4>
<p>The Principle of Complete Mediation requires all secured pages, functions and data to be protected by an authentication control. At its simplest, complete mediation could be implemented by </p>
<h4 id="enforce-authentication">Enforce authentication</h4>
<p>Authentication must be enforced in a trusted environment, such as at a policy enforcement point or server. If authentication is enforced in an untrusted location, such as on a mobile device or browser, authentication can always be bypassed. </p>
<h4 id="protect-credentials-in-transit">Protect credentials in transit</h4>
<p>Credentials, including session, API and function tokens, must be protected in transit to prevent disclosure to eavesdroppers. The dangers of unencrypted or clear text sessions has been amply shown by tools such as FireSheep, DriftNet and Dsniff. </p>
<h4 id="protect-credentials-at-rest">Protect credentials at rest</h4>
<p>Credentials, particularly API keys and passwords, must be properly protected from exposure. </p>
<p>API keys must be protected from disclosure, including in source revision control systems, as they are equivalent to username and passwords, and often allow direct remote access to an application&apos;s inner workings. </p>
<p>Passwords should be salted and hashed using a modern algorithm, with cryptographic agility to allow multiple salting and hash algorithm choices. A safe password storage scheme does not allow for the reversal of password hashes into clear text. A safe alternative today is the use of a random salt:</p>
<p>password&apos; = hash(password + salt)</p>
<p>DerivedKey = PBKDF2(PRF, password, salt, c, dkLen)</p>
<p>Where PRF is a pseudo random function, such as SHA1-HMAC </p>
<p>A strong hashing algorithm should take a considerable amount of time on a modern computer, such as multiple rounds of SHA256 or PBKDF2. </p>
<h3 id="classification-of-system">Classification of system</h3>
<h3 id="authentication-models">Authentication Models</h3>
<h4 id="single-factor">Single factor</h4>
<p>Authenticating an entity entails proving a secret is known, a tangible object is possessed, or an inherent characteristic is present. A secret could be a password or pin number. A tangible object example might be an employee ID card or Yubikey. An inherent characteristic might be biometric data like a fingerprint, retinal scan, or voice recognition.</p>
<p>But the main point is that only one of these &apos;challenges&apos; to the entity is used to compare against some known good data stored in single factor authentication. For some trivial purposes, the weak security provided by a password only authentication may be sufficient.</p>
<h4 id="multi-factor-authentication">Multi-factor authentication</h4>
<p>As laws and regulations change regularly, the reader should be aware of the regulatory environments they operate in. OWASP is not a source of legal advice. That being said, the following may be used as starting points for further research.</p>
<p>When protecting resources from the unauthorized, two-factor authentication is the bare minimum. Usual implementations employ an intangible secret with a real world factor like a physical key or palm print. The most popular implementation is with YubiKey type token generators either with a physical real world generator device or software token generator. It is rare to see multi-factor authentication security with biometric and physical infrastructure outside of government, medical, and banking applications but not unheard of.</p>
<p>For matters in the United States HIPAA for healthcare, Office of Management &amp; Budget Memorandum 07-16 for government, and Special Publication 800-63 Electronic Authentication Guideline from the National Institute of Standards and Technology all specify when two factor authentication is part of best practices if not required.</p>
<p>Australian federal government departments must comply with the first four of the ASD Top 35 in addition to Australian Privacy Principles and Medicare Act if maintaining health records.</p>
<p>Additionally, documents from ISO 2000x (specifically ISO 20007), ISO 31000 (derived from AS/NZS 4360), NZIM, Jericho Forum, ENISA IAF, BSI Germany, and BITS Shared Assessments - AUP / SIG may apply in regards to acceptable international security practices.</p>
<h4 id="knowledge-based-authentication">Knowledge based authentication</h4>
<p>There are two forms of knowledge based authentication(KBA). The first is static KBA where the system requests responses for secret information to be used during authentication. This is a frequently used method. It is straight forward to design and implement the storage of information the user provides. Unfortunately, the information requested is often not difficult to derive from other sources. For example date of birth, mother&apos;s maiden name, high school attended, pet&apos;s name, or last four digits of a Social Security number can be discovered for most people. The second type of knowledge based authentication is dynamic KBA where the system obtains data already known to the system and presents the user a challenge to verify the user knows the data the system found. Needless to say, these systems are generally more sophisticated and require more planning to execute well. A common example of dynamic KBA might include knowing the amount and/or date of the last transaction for a bank account. The bank knows when someone made their last transaction at the ATM and for what amount. This is an excellent use for knowledge based authentication because finding this information in public data stores would be unlikely. To authenticate the user in control of the bank account, the user would provide matching information to the data stored with the bank.</p>
<h4 id="risk-based-authentication">Risk based authentication</h4>
<p>Risk based authentication takes into account available information and ramps up the security as specified for the profile that is built from the information gathered. A known machine accessing resources from an internally recognized IP address during customary business hours will likely generate a very low risk profile. So, the login challenge presented to the user will likely be fast and easy. By comparison a previously unseen mobile device from outside the internal network at odd hours should generate a higher risk profile and presentation of a more involved challenge or challenges would be appropriate.</p>
<h4 id="claims-based-identity">Claims based identity</h4>
<p>This method of identifying a user involves trust. Anyone that has logged in with facebook or google has used claims based identity. The basic idea is that a third-party provides the confirmation that a user has been sufficiently vetted as being that user. This allows separation of identification and authorization &amp; access control which can simplify a lot of registration issues.</p>
<h4 id="biometric-authentication">Biometric authentication</h4>
<p>Biometric authentication</p>
<p>Biometric authentication is not suitable for most devices or systems on the following basis:</p>
<p>A) The user is covering a system owner&apos;s risk with their life and body parts. This is an unacceptable risk. 
B) Biometric credentials cannot be revoked, only removed. This means biometric credentials fail the most basic attribute of a credential - revocation. 
C) Biometric authentication relies on trust of the biometric device, which unless it is strictly controlled (such as under constant vigilance such at a border crossing), is not true.
D) The false positive rate within large user populations means that biometrics cannot be used as a single factor authentication mechanism.
E) The cost of biometric devices is relatively high compared to secure alternatives, such as transaction signing tokens or SMS one time passwords.</p>
<p>Biometric authentication can be a useful mechanism where the user has a device under their control, and is the only enrolled user </p>
<h3 id="authentication-patterns">Authentication Patterns</h3>
<h4 id="self-registration-uml">Self-registration UML</h4>
<p><img src="https://cloud.githubusercontent.com/assets/306802/3176074/60166f42-ec01-11e3-9730-f5b555b555e0.png" alt="user based registration" title="user based registration"></p>
<h4 id="credential-reset-uml">Credential reset UML</h4>
<h4 id="forgot-credential-uml">Forgot credential UML</h4>
<h4 id="rest-or-api-authentication">REST or API Authentication</h4>
<h4 id="login-uml">Login UML</h4>
<h4 id="login-uml-using-ws-security">Login UML using WS-Security*</h4>
<h4 id="login-uml-using-oauth2">Login UML using OAuth2</h4>
<h4 id="high-value-transaction-signing-uml">High value transaction signing UML</h4>
<h4 id="logout-uml">Logout UML</h4>
<h3 id="negative-patterns">Negative patterns</h3>
<h4 id="questions-and-answers">Questions and answers</h4>
<h4 id="credential-enumeration">Credential enumeration</h4>
<h4 id="horizontal-and-vertical-brute-force">Horizontal and vertical brute force</h4>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="0x04-SessionManagement.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Session management">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Authentication","level":"1.5.1","depth":2,"next":{"title":"Session management","level":"1.5.2","depth":2,"path":"03-Build/0x04-SessionManagement.md","ref":"03-Build/0x04-SessionManagement.md","articles":[]},"previous":{"title":"Build","level":"1.5","depth":1,"ref":"","articles":[{"title":"Authentication","level":"1.5.1","depth":2,"path":"03-Build/0x03-Authentication.md","ref":"03-Build/0x03-Authentication.md","articles":[]},{"title":"Session management","level":"1.5.2","depth":2,"path":"03-Build/0x04-SessionManagement.md","ref":"03-Build/0x04-SessionManagement.md","articles":[]},{"title":"Access control","level":"1.5.3","depth":2,"path":"03-Build/0x05-AccessControl.md","ref":"03-Build/0x05-AccessControl.md","articles":[]},{"title":"Input validation","level":"1.5.4","depth":2,"path":"03-Build/0x06-InputValidation.md","ref":"03-Build/0x06-InputValidation.md","articles":[]},{"title":"Output encoding","level":"1.5.5","depth":2,"path":"03-Build/0x06-OutputEncoding.md","ref":"03-Build/0x06-OutputEncoding.md","articles":[]},{"title":"Business logic","level":"1.5.6","depth":2,"path":"03-Build/0x07-BusinessLogic.md","ref":"03-Build/0x07-BusinessLogic.md","articles":[]},{"title":"Accountability","level":"1.5.7","depth":2,"path":"03-Build/0x08-Accountability.md","ref":"03-Build/0x08-Accountability.md","articles":[]},{"title":"Data protection","level":"1.5.8","depth":2,"path":"03-Build/0x09-DataProtection.md","ref":"03-Build/0x09-DataProtection.md","articles":[]},{"title":"Files and resources","level":"1.5.9","depth":2,"path":"03-Build/0x10-FilesAndResources.md","ref":"03-Build/0x10-FilesAndResources.md","articles":[]},{"title":"Cryptography","level":"1.5.10","depth":2,"path":"03-Build/0x11-Cryptography.md","ref":"03-Build/0x11-Cryptography.md","articles":[]},{"title":"Memory","level":"1.5.11","depth":2,"path":"03-Build/0x14-Memory.md","ref":"03-Build/0x14-Memory.md","articles":[]},{"title":"Concurrency","level":"1.5.12","depth":2,"path":"03-Build/0x15-Concurrency.md","ref":"03-Build/0x15-Concurrency.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"03-Build/0x03-Authentication.md","mtime":"2019-06-24T13:47:49.581Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-06-28T09:34:14.372Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

